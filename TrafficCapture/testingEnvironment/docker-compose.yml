version: '3.7'
services:
  webserver:
    build:
      context: nginx/
      dockerfile: nginx.Dockerfile
    ports:
      - "8080:80"
    depends_on:
      - proxy
  proxy:
    build:
      context: trafficCaptureProxy/
      dockerfile: Proxy.Dockerfile
    ports:
      - "9201:9201"
    environment:
      BACKSIDE_HOST: webserver
      BACKSIDE_PORT: 80
      BIND_PORT: 9201

  jmeter:
    build:
      context: JMeter/
      dockerfile: JMeter.Dockerfile
    depends_on:
      - webserver
    environment:
      DOMAIN_NAME: proxy
      BIND_PORT: 9201

networks:
  my-net:
    driver: bridge
